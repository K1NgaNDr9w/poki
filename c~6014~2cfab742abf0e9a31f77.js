"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6014],{6014:(e,t,n)=>{n.r(t),n.d(t,{fixIOSFullscreen:()=>F,forwardPostMessageEpic:()=>x,fullscreenEpic:()=>G,gameBootEpic:()=>R,gameLoadingFinishedEpic:()=>J,pubHostInitializedEpic:()=>T,receivePostMessageEpic:()=>O,setRecentGameEpic:()=>C,switchWorldToEpic:()=>U,updatePokiURLParams:()=>P,worldSwitchedToEpic:()=>S});var o=n(1545),i=n(2817),l=n(2401),a=n(9635),r=n(3071),c=n(4975),s=n(2006),d=n(9127),u=n(533),p=n(4978),w=n(6108),g=n(8966),v=n(5069),m=n(8813),f=n(905),h=n(3748),y=n(4481),E=n(6151),_=n(7344),b=n(8855),B=n(8656),D=n(6619),k=n(9563),I=n(65),L=n(4927);const A=["localhost","games.poki.com","game-cdn.poki.com"],M={CrossyMultiverseMessage_worldSwitchedTo:f.VN,pubHostInitialized:f.B5,[k.cO]:f.OB,[k.xE]:f.aw,[k.A$]:f.PP,[k.Yn]:f.iq,SaveGameMigrator:!0};function O(e,t){return e.pipe((0,v.l)(f.y6.type),(0,c.h)((e=>{let{event:t}=e;if(!t.data.type||!M[t.data.type])return!1;const n=(0,y._Y)(t.origin),o=A.includes(n)||n.endsWith(".poki-gdn.com")||window.location.origin===t.origin,i=document.querySelector('iframe[name="gameFrame"]'),l=i&&i.src.startsWith(t.origin);return o||l})),(0,s.b)((e=>{let{event:{data:{content:t,type:n}}}=e;if(["pokiMessageEvent","pokiMessageDebug","SaveGameMigrator"].includes(n)&&((0,h.A)("sdk","message",{content:t,type:n}),window.parent!==window)){const e="production"===process.env.SERVICE_ENV;window.parent.postMessage({content:t,type:n},e?"devs.poki.io":"*")}})),(0,c.h)((e=>{var n,o;let{event:i}=e,l=null===(n=i.data.content)||void 0===n||null===(o=n.pokifordevs)||void 0===o?void 0:o.game_id;var a;l||(l=null===(a=i.data.content)||void 0===a?void 0:a.gameID);const r=(0,B.J1)(t.value);return!(!r||!l||l!=="".concat(r.pokifordevs_game_id))})),(0,c.h)((e=>{let{event:{data:{type:t}}}=e;return"function"==typeof M[t]})),(0,d.U)((e=>{let{event:{data:{content:t,type:n}}}=e;return M[n](t)})))}function U(e,t){return e.pipe((0,v.l)(f.Ot.type),(0,c.h)((()=>window.frames.gameFrame)),(0,c.h)((e=>{let{world:n}=e;return(0,b.Bs)(t.value)!==n})),(0,s.b)((e=>{let{world:t}=e;window.frames.gameFrame.postMessage({type:"CrossyMultiverseMessage_switchWorldTo",content:{worldName:t}},"*")})),(0,d.U)((e=>(0,f.Bn)({world:e,gameId:(0,B.J1)(t.value).id}))))}function S(e,t){return e.pipe((0,v.l)(f.VN.type),(0,d.U)((e=>{let{worldName:t}=e;return t})),(0,c.h)((e=>(0,b.Bs)(t.value)!==e)),(0,d.U)((e=>(0,f.Bn)({world:e,gameId:(0,B.J1)(t.value).id}))))}function P(e){return e.pipe((0,v.l)(f.PP.type),(0,s.b)((e=>{const{params:t}=e;if(!t)return;const n=Object.keys(t),o=new URLSearchParams(window.location.search),i=[];o.forEach(((e,t)=>{t.startsWith("gd")&&i.push(t)})),i.forEach((e=>{o.delete(e)})),n.forEach((e=>{o.set("gd".concat(e),t[e])})),window.history.replaceState({},document.title,"".concat(window.location.pathname,"?").concat(o.toString()))})),(0,u.l)())}function R(e){return e.pipe((0,v.l)(f.Gq.type),(0,s.b)((()=>{(0,h.A)("game","boot"),(0,I.u)()})),(0,u.l)())}function T(e,t){return e.pipe((0,v.l)(f.B5.type),(0,p.w)((e=>{const n=(0,B.J1)(t.value);return n?((0,h.A)("pubHost","initialized",e),(0,i.of)((0,f.P8)({gameId:n.id,data:e}))):o.E})))}function x(){return window.removeEventListener("message",messageListener),(0,l.R)(window,"message").pipe((0,w.O)(...messageBuffer),(0,d.U)((e=>(0,f.y6)({event:e}))))}const H=()=>document.getElementById("game-container"),N=()=>{const e=document.getElementById("game-element");window.scrollTo(0,0),e.style.width="".concat(window.innerWidth,"px"),e.style.height="".concat(window.innerHeight,"px")};function F(e,t){return e.pipe((0,v.l)(f.Gq.type),(0,s.b)((()=>{const e=(0,E.eD)(t.value);"undefined"!=typeof navigator&&"undefined"!=typeof window&&e&&((0,I.u)(),window.addEventListener("resize",N),N(),setTimeout((()=>{N()}),3e3))})),(0,u.l)())}const W=async(e,t)=>{if(!(0,E.At)(t)){try{var n;await(null==e||null===(n=e.requestFullscreen)||void 0===n?void 0:n.call(e,{navigationUI:"hide"}).catch((()=>{})))}catch(e){}e.focus()}const o=(0,B.J1)(t);if((0,E.eD)(t)&&o&&o.mobile_file&&o.mobile_file.orientation){const{orientation:e}=o.mobile_file;if(["portrait","landscape"].includes(e))try{var i,l,a,r;null===(i=window)||void 0===i||null===(l=i.screen)||void 0===l||null===(a=l.orientation)||void 0===a||null===(r=a.lock)||void 0===r||r.call(a,e).catch((()=>{}))}catch(e){}}};function C(e,t){return e.pipe((0,v.l)(m.HI.type),(0,p.w)((e=>{let{data:n}=e;if("undefined"==typeof window)return o.E;if("game"!==(0,B.Wj)(t.value))return o.E;const l=(0,_.lH)(t.value),{id:a}=n.details;return(0,i.of)((0,m.FR)({id:a,siteID:l.id}))})))}function G(e,t){const n=e.pipe((0,v.l)(m.JV.type),(0,c.h)((()=>window.matchMedia("(display-mode: standalone)").matches)),(0,d.U)((()=>(0,f.Zx)({toggle:!0})))),w=(0,l.R)(window,"fullscreenchange").pipe((0,p.w)((()=>{var e,n,l;return(0,D.k)(),(0,b.Eo)(t.value)!==!(null===(e=document)||void 0===e||!e.fullscreenElement)&&(!(0,E.eD)(t.value)||null!==(n=document)&&void 0!==n&&n.fullscreenElement)?(0,i.of)((0,f.K1)({toggle:!(null===(l=document)||void 0===l||!l.fullscreenElement)})):o.E}))),h=e.pipe((0,v.l)(f.Zx.type),(0,c.h)((e=>{let{toggle:t}=e;return t})),(0,p.w)((()=>{const e=H();return e?(0,a.D)(W(e,t.value)).pipe((0,d.U)((()=>(0,f.K1)({toggle:!0})))):o.E}))),y=e.pipe((0,v.l)(f.Zx.type),(0,c.h)((e=>{let{toggle:t}=e;return!t})),(0,p.w)((()=>{try{var e,t;null===(e=document)||void 0===e||null===(t=e.exitFullscreen)||void 0===t||t.call(e).catch((()=>{}))}catch(e){}return window.removeEventListener("resize",N),(0,i.of)((0,f.K1)({toggle:!1}))}))),_="fullscreen",B=(0,r.T)(e.pipe((0,v.l)(f.K1.type),(0,s.b)((e=>{let{toggle:t}=e;window.location.hash=t?_:""})),(0,u.l)()),e.pipe((0,v.l)(m.JV.type,"@@router/LOCATION_CHANGE",L.ZB.type),(0,p.w)((()=>{const e=window.location.hash==="#".concat(_),n=(0,b.dW)(t.value),l=(0,E.eD)(t.value);return(0,b.Eo)(t.value)!==e&&(n||l)?(0,i.of)((0,f.Zx)({toggle:e})):o.E})))),k=e.pipe((0,v.l)(f.Gq.type),(0,c.h)((e=>{let{el:n}=e;return(0,E.eD)(t.value)&&n})),(0,p.w)((e=>{let{el:n}=e;return(0,r.T)((0,l.R)(H(),"click"),(0,l.R)(n,"click")).pipe((0,c.h)((()=>(0,E.eD)(t.value))),(0,s.b)((()=>{const e=H();W(e,t.value)})),(0,g.R)(y),(0,u.l)())}))),I=e.pipe((0,v.l)(f.K1.type),(0,p.w)((e=>{let{toggle:t}=e;const n=document.getElementById("app-root");return n.style.overflow=t?"hidden":"auto",n.style.height=t?"100vh":"auto",o.E})));return(0,r.T)(h,n,y,w,B,k,I)}function J(e){return e.pipe((0,v.l)(f.OB.type),(0,c.h)((e=>{let{event:t}=e;return t===k.tn})),(0,d.U)((()=>(0,f.sn)())))}}}]);